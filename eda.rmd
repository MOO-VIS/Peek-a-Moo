```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
suppressPackageStartupMessages(library(qqplotr))
library(tidyverse, quietly = TRUE)
library(broom)
library(lubridate)
library(plotly)
library(ggplot2)
library(kableExtra)
```

```{r}

my_df <- bind_rows(dashboard_Insentec$`Replacement behaviour by date`, .id = "date")

my_df

```


```{r}
actor_reactor_analysis <- my_df %>%
    group_by(Actor_cow, date) %>%
    mutate(actor_cow_freq = n(),
           unique_reactor_cows_kicked = length(unique(Reactor_cow))) %>%
    ungroup() %>%
    group_by(Reactor_cow, date) %>%
    mutate(reactor_cow_freq = n(), 
           unique_actor_cows_kicking = length(unique(Actor_cow)))

actor_reactor_analysis
```

```{r}
cow_id = 6130

cow_6130 <- actor_reactor_analysis %>%
          filter(Actor_cow == cow_id)  
          

cow_6130$date <- ymd(cow_6130$date)

cow_6130
```

```{r}

first_plot <- ggplot(cow_6130, aes(x = date)) +
  
  geom_line(aes(y = actor_cow_freq), color="steelblue") +
  geom_line(aes(y = unique_reactor_cows_kicked), color="red") +
  geom_point(aes(y = actor_cow_freq)) +
  geom_point(aes(y = unique_reactor_cows_kicked)) +
  scale_x_date(date_labels = "%B-%y") +
  #theme_ipsum() +
  labs(x = '', y = 'Number of times Cow 6130 was actor cow') +
  theme(axis.text.x=element_text(angle=60, hjust=1))

ggplotly(first_plot)
```


